<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MangaVerse | Your Ultimate Manga Reading Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        secondary: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                        },
                        dark: {
                            900: '#0f172a',
                            800: '#1e293b',
                            700: '#334155',
                            600: '#475569',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom CSS for elements not easily done with Tailwind */
        .manga-card {
            transition: all 0.3s ease;
        }
        .manga-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .chapter-list-item:hover {
            background-color: rgba(14, 165, 233, 0.1);
        }
        .reader-container {
            scroll-snap-type: y mandatory;
        }
        .reader-page {
            scroll-snap-align: start;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        /* Dark mode scrollbar */
        .dark ::-webkit-scrollbar-track {
            background: #1e293b;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #475569;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-dark-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
    <button id="darkModeToggle" class="fixed bottom-6 right-6 z-50 p-3 rounded-full bg-primary-600 text-white shadow-lg hover:bg-primary-700 transition-colors">
        <i class="fas fa-moon hidden"></i>
        <i class="fas fa-sun hidden"></i>
    </button>

    <header class="sticky top-0 z-40 bg-white dark:bg-dark-800 shadow-sm">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <a href="#" class="text-2xl font-bold text-primary-600 dark:text-primary-400 flex items-center">
                        <i class="fas fa-book-open mr-2"></i>
                        <span>MangaVerse</span>
                    </a>
                </div>
                
                <nav class="hidden md:flex items-center space-x-8">
                    <a href="#" class="font-medium hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Home</a>
                    <a href="#" class="font-medium hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Popular</a>
                    <a href="#" class="font-medium hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Latest</a>
                    <a href="#" class="font-medium hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Genres</a>
                </nav>
                
                <div class="flex items-center space-x-4">
                    <div class="relative hidden md:block">
                        <input type="text" placeholder="Search manga..." class="pl-10 pr-4 py-2 rounded-full border border-gray-300 dark:border-gray-600 bg-transparent focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent w-64">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                    <button class="md:hidden text-gray-700 dark:text-gray-300">
                        <i class="fas fa-search text-xl"></i>
                    </button>
                    <a href="#" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors">
                        <i class="fas fa-bookmark text-xl"></i>
                    </a>
                    <a href="#" class="h-9 w-9 rounded-full bg-primary-600 flex items-center justify-center text-white">
                        <i class="fas fa-user"></i>
                    </a>
                    <button id="mobileMenuButton" class="md:hidden text-gray-700 dark:text-gray-300">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div id="mobileMenu" class="hidden md:hidden bg-white dark:bg-dark-800 border-t border-gray-200 dark:border-gray-700">
            <div class="container mx-auto px-4 py-3">
                <div class="flex flex-col space-y-4">
                    <div class="relative">
                        <input type="text" placeholder="Search manga..." class="pl-10 pr-4 py-2 rounded-full border border-gray-300 dark:border-gray-600 bg-transparent focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent w-full">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                    <a href="#" class="font-medium py-2 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Home</a>
                    <a href="#" class="font-medium py-2 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Popular</a>
                    <a href="#" class="font-medium py-2 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Latest</a>
                    <a href="#" class="font-medium py-2 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Genres</a>
                    <a href="#" class="font-medium py-2 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">History</a>
                    <a href="#" class="font-medium py-2 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Bookmarks</a>
                </div>
            </div>
        </div>
    </header>

    <main class="min-h-screen pb-12">
        <section class="relative bg-gradient-to-r from-primary-600 to-primary-800 text-white">
            <div class="container mx-auto px-4 py-16 md:py-24">
                <div class="flex flex-col md:flex-row items-center">
                    <div class="md:w-1/2 mb-8 md:mb-0 md:pr-8">
                        <h1 class="text-4xl md:text-5xl font-bold mb-4">Discover Your Next Favorite Manga</h1>
                        <p class="text-xl mb-6">Read thousands of manga, manhwa, and manhua for free. Unlimited access, no ads.</p>
                        <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4">
                            <a href="#" class="bg-white text-primary-600 hover:bg-gray-100 px-6 py-3 rounded-lg text-center font-semibold transition-colors">
                                <i class="fas fa-book-open mr-2"></i> Start Reading
                            </a>
                            <a href="#ai-search" class="bg-primary-700 hover:bg-primary-800 px-6 py-3 rounded-lg text-center font-semibold transition-colors">
                                <i class="fas fa-image mr-2"></i> Find by Image
                            </a>
                        </div>
                    </div>
                    <div class="md:w-1/2">
                        <div class="relative">
                            <div class="absolute -top-4 -left-4 h-full w-full border-4 border-primary-500 rounded-lg z-0"></div>
                            <div class="relative z-10">
                                <img src="https://via.placeholder.com/600x400/1e293b/ffffff?text=Featured+Manga" alt="Featured Manga" class="rounded-lg shadow-xl w-full h-auto">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="bg-white dark:bg-dark-800 shadow-sm">
            <div class="container mx-auto px-4">
                <div class="flex overflow-x-auto py-3 space-x-6 hide-scrollbar">
                    <a href="#" class="flex flex-col items-center px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors shrink-0">
                        <i class="fas fa-fire text-xl mb-1 text-primary-600"></i>
                        <span class="text-sm font-medium">Popular</span>
                    </a>
                    <a href="#" class="flex flex-col items-center px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors shrink-0">
                        <i class="fas fa-clock text-xl mb-1 text-primary-600"></i>
                        <span class="text-sm font-medium">Latest</span>
                    </a>
                    <a href="#" class="flex flex-col items-center px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors shrink-0">
                        <i class="fas fa-calendar-star text-xl mb-1 text-primary-600"></i>
                        <span class="text-sm font-medium">New</span>
                    </a>
                    <a href="#" class="flex flex-col items-center px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors shrink-0">
                        <i class="fas fa-heart text-xl mb-1 text-primary-600"></i>
                        <span class="text-sm font-medium">Romance</span>
                    </a>
                    <a href="#" class="flex flex-col items-center px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors shrink-0">
                        <i class="fas fa-fist-raised text-xl mb-1 text-primary-600"></i>
                        <span class="text-sm font-medium">Action</span>
                    </a>
                    <a href="#" class="flex flex-col items-center px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors shrink-0">
                        <i class="fas fa-robot text-xl mb-1 text-primary-600"></i>
                        <span class="text-sm font-medium">Sci-Fi</span>
                    </a>
                    <a href="#" class="flex flex-col items-center px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-dark-700 transition-colors shrink-0">
                        <i class="fas fa-ghost text-xl mb-1 text-primary-600"></i>
                        <span class="text-sm font-medium">Horror</span>
                    </a>
                </div>
            </div>
        </section>

        <section class="py-12">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between mb-8">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-primary-600 rounded-lg flex items-center justify-center text-white">
                            <i class="fas fa-fire"></i>
                        </div>
                        <h2 class="text-2xl font-bold">Popular Manga This Week</h2>
                    </div>
                    <a href="#" class="text-primary-600 dark:text-primary-400 hover:underline flex items-center">
                        View All <i class="fas fa-chevron-right ml-1 text-sm"></i>
                    </a>
                </div>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6">
                    <div class="col-span-full text-center py-8">
                        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mx-auto mb-4"></div>
                        <p class="text-gray-600 dark:text-gray-300">Loading popular manga...</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-12 bg-gray-100 dark:bg-dark-800">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between mb-8">
                    <h2 class="text-2xl font-bold">Latest Updates</h2>
                    <a href="#" class="text-primary-600 dark:text-primary-400 hover:underline">View All</a>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="col-span-full text-center py-8">
                        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mx-auto mb-4"></div>
                        <p class="text-gray-600 dark:text-gray-300">Loading latest updates...</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="ai-search" class="py-12">
            <div class="container mx-auto px-4">
                <div class="text-center mb-12">
                    <h2 class="text-2xl font-bold mb-4">Can't Remember the Title?</h2>
                    <p class="text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">Upload a screenshot or take a photo of any manga panel and our AI will find it for you!</p>
                </div>
                
                <div class="bg-white dark:bg-dark-800 rounded-xl shadow-lg overflow-hidden max-w-4xl mx-auto">
                    <div class="flex flex-col md:flex-row">
                        <div class="md:w-1/2 p-6 md:p-8">
                            <div id="dropArea" class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg px-6 py-12 text-center transition-colors hover:border-primary-500 cursor-pointer">
                                <input type="file" id="fileInput" accept="image/*" capture="environment" class="hidden">
                                <div class="flex justify-center mb-4">
                                    <i class="fas fa-image text-4xl text-primary-500"></i>
                                </div>
                                <h3 class="text-lg font-semibold mb-2">Drag & Drop Image Here</h3>
                                <p class="text-gray-500 dark:text-gray-400 mb-4">or</p>
                                <button id="uploadButton" class="bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                                    Browse Files
                                </button>
                                <button id="cameraButton" class="mt-3 bg-gray-100 dark:bg-dark-700 hover:bg-gray-200 dark:hover:bg-dark-600 text-gray-800 dark:text-gray-200 px-6 py-2 rounded-lg font-medium transition-colors">
                                    <i class="fas fa-camera mr-2"></i> Take Photo
                                </button>
                            </div>
                        </div>
                        
                        <div class="md:w-1/2 bg-gray-50 dark:bg-dark-700 p-6 md:p-8">
                            <h3 class="text-lg font-semibold mb-4">Search Results</h3>
                            <div id="resultsContainer" class="text-center py-8">
                                <div class="flex justify-center mb-4">
                                    <i class="fas fa-search text-3xl text-gray-400"></i>
                                </div>
                                <p class="text-gray-500 dark:text-gray-400">Upload a manga image or take a photo to search</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-12 bg-gray-100 dark:bg-dark-800">
            <div class="container mx-auto px-4">
                <h2 class="text-2xl font-bold mb-8 text-center">Browse by Genre</h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-300 flex items-center justify-center">
                            <i class="fas fa-fist-raised text-xl"></i>
                        </div>
                        <span class="font-medium">Action</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-pink-100 dark:bg-pink-900 text-pink-600 dark:text-pink-300 flex items-center justify-center">
                            <i class="fas fa-heart text-xl"></i>
                        </div>
                        <span class="font-medium">Romance</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 flex items-center justify-center">
                            <i class="fas fa-robot text-xl"></i>
                        </div>
                        <span class="font-medium">Sci-Fi</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-300 flex items center-center justify-center">
                            <i class="fas fa-ghost text-xl"></i>
                        </div>
                        <span class="font-medium">Horror</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 flex items-center justify-center">
                            <i class="fas fa-laugh-beam text-xl"></i>
                        </div>
                        <span class="font-medium">Comedy</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-yellow-100 dark:bg-yellow-900 text-yellow-600 dark:text-yellow-300 flex items-center justify-center">
                            <i class="fas fa-hat-wizard text-xl"></i>
                        </div>
                        <span class="font-medium">Fantasy</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-300 flex items-center justify-center">
                            <i class="fas fa-user-ninja text-xl"></i>
                        </div>
                        <span class="font-medium">Adventure</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-orange-100 dark:bg-orange-900 text-orange-600 dark:text-orange-300 flex items-center justify-center">
                            <i class="fas fa-gamepad text-xl"></i>
                        </div>
                        <span class="font-medium">Sports</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-cyan-100 dark:bg-cyan-900 text-cyan-600 dark:text-cyan-300 flex items-center justify-center">
                            <i class="fas fa-user-graduate text-xl"></i>
                        </div>
                        <span class="font-medium">School Life</span>
                    </a>
                    <a href="#" class="block bg-white dark:bg-dark-700 rounded-lg shadow p-4 text-center hover:bg-primary-50 dark:hover:bg-dark-600 transition-colors">
                        <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 flex items-center justify-center">
                            <i class="fas fa-eye text-xl"></i>
                        </div>
                        <span class="font-medium">Mystery</span>
                    </a>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-dark-900 text-white pt-12 pb-6">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-book-open mr-2"></i>
                        <span>MangaVerse</span>
                    </h3>
                    <p class="text-gray-400">The ultimate platform for manga, manhwa, and manhua lovers. Read your favorite comics anytime, anywhere.</p>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Home</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Popular</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Latest Updates</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Genres</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-4">Community</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Forums</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Discord</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Twitter</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Instagram</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-4">Legal</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Terms of Service</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Privacy Policy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">DMCA</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 pt-6">
                <p class="text-center text-gray-500 text-sm">© 2023 MangaVerse. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <div id="mangaDetailModal" class="fixed inset-0 z-50 overflow-y-auto hidden">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                <div class="absolute inset-0 bg-gray-900 dark:bg-gray-900 opacity-75"></div>
            </div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-white dark:bg-dark-700 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full">
                <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="flex flex-col md:flex-row">
                        <div class="md:w-1/3 mb-6 md:mb-0 md:pr-6">
                            <img src="https://via.placeholder.com/400x600/4f46e5/ffffff?text=Manga" alt="Manga Cover" class="rounded-lg shadow-md w-full h-auto">
                        </div>
                        <div class="md:w-2/3">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="text-2xl font-bold mb-2">Attack on Titan: Final Season</h3>
                                    <p class="text-gray-600 dark:text-gray-300 mb-4">By Hajime Isayama</p>
                                </div>
                                <button id="closeDetailModal" class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                            <div class="flex flex-wrap gap-2 mb-4">
                                <span class="bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 px-3 py-1 rounded-full text-sm">Action</span>
                                <span class="bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 px-3 py-1 rounded-full text-sm">Drama</span>
                                <span class="bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 px-3 py-1 rounded-full text-sm">Sci-Fi</span>
                            </div>
                            <div class="flex items-center mb-4">
                                <div class="flex mr-2">
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star-half-alt text-yellow-400"></i>
                                </div>
                                <span class="text-gray-600 dark:text-gray-300 text-sm">4.7 (12,345 ratings)</span>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-bold mb-2">Synopsis</h4>
                                <p class="text-gray-700 dark:text-gray-300 text-sm">Humanity has been living inside three walls that protect them from the giant Titans. After Wall Maria is breached by the Colossal and Armored Titans, Eren Yeager and his friends join the Survey Corps in their fight against the Titans outside the walls.</p>
                            </div>
                            <div class="mb-6">
                                <h4 class="font-bold mb-2">Details</h4>
                                <div class="grid grid-cols-2 gap-2 text-sm">
                                    <div>
                                        <span class="text-gray-600 dark:text-gray-400">Status:</span>
                                        <span class="font-medium">Ongoing</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600 dark:text-gray-400">Chapters:</span>
                                        <span class="font-medium">138</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600 dark:text-gray-400">Published:</span>
                                        <span class="font-medium">2009 - Present</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-600 dark:text-gray-400">Author:</span>
                                        <span class="font-medium">Hajime Isayama</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex flex-col sm:flex-row gap-3">
                                <button class="bg-primary-600 hover:bg-primary-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex-1 text-center">
                                    <i class="fas fa-book-open mr-2"></i> Read Now
                                </button>
                                <button class="bg-gray-200 dark:bg-dark-600 hover:bg-gray-300 dark:hover:bg-dark-500 text-gray-800 dark:text-gray-200 px-6 py-3 rounded-lg font-medium transition-colors flex-1 text-center">
                                    <i class="fas fa-bookmark mr-2"></i> Bookmark
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="readerModal" class="fixed inset-0 z-50 hidden overflow-hidden">
        <div class="absolute inset-0 bg-black">
            <div id="readerHeader" class="absolute top-0 left-0 right-0 bg-gradient-to-b from-black/80 to-transparent px-4 py-3 flex justify-between items-center transition-opacity duration-300">
                <button id="closeReader" class="text-white hover:text-gray-300">
                    <i class="fas fa-times text-xl"></i>
                </button>
                <h3 class="text-white font-medium truncate mx-4">Attack on Titan - Chapter 138</h3>
                <div class="flex items-center space-x-3">
                    <button class="text-white hover:text-gray-300">
                        <i class="fas fa-cog text-xl"></i>
                    </button>
                    <button class="text-white hover:text-gray-300">
                        <i class="fas fa-bookmark text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div id="readerContent" class="h-full flex items-center justify-center overflow-auto">
                <div class="max-w-screen-lg w-full px-4 py-16">
                    <div class="bg-white rounded-lg overflow-hidden">
                        <div class="reader-container h-96 overflow-y-auto">
                            <div class="reader-page w-full h-full flex items-center justify-center bg-gray-100">
                                <p class="text-gray-700">Loading manga pages...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="readerFooter" class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent px-4 py-3 flex justify-between items-center transition-opacity duration-300">
                <button class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded">
                    <i class="fas fa-arrow-left mr-2"></i> Previous Chapter
                </button>
                <div class="flex items-center space-x-4 text-white">
                    <button class="hover:text-gray-300">
                        <i class="fas fa-th-list"></i>
                    </button>
                    <select class="bg-gray-800 text-white border-gray-700 rounded px-2 py-1">
                        <option>Page 1</option>
                        <option>Page 2</option>
                        <option>Page 3</option>
                    </select>
                    <span>1/24</span>
                </div>
                <button class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded">
                    Next Chapter <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
            
            <div class="absolute left-1/2 -translate-x-1/2 bottom-20 bg-gray-800 bg-opacity-70 rounded-full p-2 flex items-center space-x-2">
                <button class="w-10 h-10 rounded-full bg-gray-700 text-white hover:bg-gray-600 flex items-center justify-center">
                    <i class="fas fa-sun"></i>
                </button>
                <button class="w-10 h-10 rounded-full bg-gray-700 text-white hover:bg-gray-600 flex items-center justify-center">
                    <i class="fas fa-columns"></i>
                </button>
                <button class="w-10 h-10 rounded-full bg-gray-700 text-white hover:bg-gray-600 flex items-center justify-center">
                    <i class="fas fa-expand"></i>
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        // MangaDex API Functions (copied from mangadex-api.js)
        const MANGADEX_API_BASE_URL = 'https://api.mangadex.org';
        const UPLOADS_API_BASE_URL = 'https://uploads.mangadex.org';

        async function fetchFromMangaDexApi(endpoint, params = {}) {
            const url = new URL(`${MANGADEX_API_BASE_URL}${endpoint}`);
            Object.keys(params).forEach(key => url.searchParams.append(key, params[key]));

            try {
                const response = await fetch(url.toString(), {
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`MangaDex API Error: ${response.status} - ${errorData.errors?.[0]?.detail || response.statusText}`);
                }

                return await response.json();
            } catch (error) {
                console.error(`Failed to fetch from MangaDex API: ${error}`);
                throw error;
            }
        }

        async function getMangaList(query = '', limit = 20, offset = 0, includes = ['cover_art', 'author', 'artist'], order = { 'followedCount': 'desc' }) {
            const params = {
                limit: limit,
                offset: offset,
                'includes[]': includes,
                'order[followedCount]': order.followedCount,
            };

            if (query) {
                params.title = query;
            }

            try {
                const data = await fetchFromMangaDexApi('/manga', params);
                return data.data.map(manga => {
                    const attributes = manga.attributes;
                    const coverArtRelationship = manga.relationships.find(rel => rel.type === 'cover_art');
                    const authorRelationship = manga.relationships.find(rel => rel.type === 'author');

                    return {
                        id: manga.id,
                        title: attributes.title.en || Object.values(attributes.title)[0],
                        description: attributes.description.en || Object.values(attributes.description)[0] || 'No description available.',
                        status: attributes.status,
                        year: attributes.year,
                        contentRating: attributes.contentRating,
                        tags: attributes.tags.map(tag => tag.attributes.name.en),
                        altTitles: attributes.altTitles.map(alt => Object.values(alt)[0]),
                        lastChapter: attributes.lastChapter,
                        lastVolume: attributes.lastVolume,
                        publicationDemographic: attributes.publicationDemographic,
                        coverArtFileName: coverArtRelationship ? coverArtRelationship.attributes.fileName : null,
                        author: authorRelationship ? authorRelationship.attributes.name : 'Unknown',
                    };
                });
            } catch (error) {
                console.error("Error fetching manga list:", error);
                return [];
            }
        }

        async function getMangaDetails(mangaId, includes = ['cover_art', 'author', 'artist', 'tag']) {
            try {
                const data = await fetchFromMangaDexApi(`/manga/${mangaId}`, { 'includes[]': includes });
                const manga = data.data;
                const attributes = manga.attributes;
                const coverArtRelationship = manga.relationships.find(rel => rel.type === 'cover_art');
                const authorRelationship = manga.relationships.find(rel => rel.type === 'author');
                const artistRelationship = manga.relationships.find(rel => rel.type === 'artist');

                return {
                    id: manga.id,
                    title: attributes.title.en || Object.values(attributes.title)[0],
                    description: attributes.description.en || Object.values(attributes.description)[0] || 'No description available.',
                    status: attributes.status,
                    year: attributes.year,
                    contentRating: attributes.contentRating,
                    tags: attributes.tags.map(tag => tag.attributes.name.en),
                    altTitles: attributes.altTitles.map(alt => Object.values(alt)[0]),
                    lastChapter: attributes.lastChapter,
                    lastVolume: attributes.lastVolume,
                    publicationDemographic: attributes.publicationDemographic,
                    coverArtFileName: coverArtRelationship ? coverArtRelationship.attributes.fileName : null,
                    author: authorRelationship ? authorRelationship.attributes.name : 'Unknown',
                    artist: artistRelationship ? artistRelationship.attributes.name : 'Unknown',
                };
            } catch (error) {
                console.error(`Error fetching manga details for ${mangaId}:`, error);
                return null;
            }
        }

        function getCoverArtUrl(mangaId, fileName, quality = 'full') {
            if (!mangaId || !fileName) {
                return `https://via.placeholder.com/200x280?text=No+Cover`;
            }
            const qualityPrefix = quality === 'thumb' ? '.256.jpg' : '';
            return `${UPLOADS_API_BASE_URL}/covers/${mangaId}/${fileName}${qualityPrefix}`;
        }

        async function getMangaChapters(mangaId, limit = 500, offset = 0) {
            try {
                const data = await fetchFromMangaDexApi('/chapter', {
                    'manga': mangaId,
                    limit: limit,
                    offset: offset,
                    order: {
                        chapter: 'asc',
                        createdAt: 'asc'
                    },
                    translatedLanguage: ['en'],
                    'includes[]': ['scanlation_group']
                });

                return data.data.map(chapter => {
                    const attributes = chapter.attributes;
                    const scanlationGroup = chapter.relationships.find(rel => rel.type === 'scanlation_group');
                    return {
                        id: chapter.id,
                        chapter: attributes.chapter,
                        title: attributes.title,
                        pages: attributes.pages,
                        publishAt: attributes.publishAt,
                        externalUrl: attributes.externalUrl,
                        scanlationGroup: scanlationGroup ? scanlationGroup.attributes.name : 'Unknown',
                    };
                });
            } catch (error) {
                console.error(`Error fetching chapters for manga ${mangaId}:`, error);
                return [];
            }
        }

        async function getChapterImages(chapterId, dataSaver = true) {
            try {
                const data = await fetchFromMangaDexApi(`/at-home/server/${chapterId}`);
                const chapterHash = data.chapter.hash;
                const images = dataSaver ? data.chapter.dataSaver : data.chapter.data;

                return {
                    baseUrl: data.baseUrl,
                    chapterHash: chapterHash,
                    images: images
                };
            } catch (error) {
                console.error(`Error fetching chapter images for ${chapterId}:`, error);
                return null;
            }
        }

        function buildChapterImageUrls(baseUrl, chapterHash, imageFileNames, dataSaver = true) {
            const qualityPrefix = dataSaver ? 'data-saver' : 'data';
            return imageFileNames.map(fileName => {
                return `${baseUrl}/${qualityPrefix}/${chapterHash}/${fileName}`;
            });
        }

        // Dark Mode Toggle
        const darkModeToggle = document.getElementById('darkModeToggle');
        const moonIcon = darkModeToggle.querySelector('.fa-moon');
        const sunIcon = darkModeToggle.querySelector('.fa-sun');
        
        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'enabled' || (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            sunIcon.classList.remove('hidden');
            moonIcon.classList.add('hidden');
        } else {
            moonIcon.classList.remove('hidden');
            sunIcon.classList.add('hidden');
        }
        
        darkModeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            
            if (document.documentElement.classList.contains('dark')) {
                localStorage.setItem('darkMode', 'enabled');
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            } else {
                localStorage.setItem('darkMode', 'disabled');
                moonIcon.classList.remove('hidden');
                sunIcon.classList.add('hidden');
            }
        });
        
        // Mobile Menu Toggle
        const mobileMenuButton = document.getElementById('mobileMenuButton');
        const mobileMenu = document.getElementById('mobileMenu');
        
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        
        // Functions to render manga sections
        async function renderPopularManga() {
            const popularMangaSection = document.querySelector('.grid.grid-cols-2.sm\\:grid-cols-3.md\\:grid-cols-4.lg\\:grid-cols-5.xl\\:grid-cols-6.gap-4.md\\:gap-6');
            popularMangaSection.innerHTML = `
                <div class="col-span-full text-center py-8">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mx-auto mb-4"></div>
                    <p class="text-gray-600 dark:text-gray-300">Loading popular manga...</p>
                </div>
            `;
            
            try {
                const mangaList = await getMangaList('', 12, 0, ['cover_art', 'author']); // Ambil 12 manga populer
                popularMangaSection.innerHTML = ''; // Bersihkan loader

                if (mangaList.length === 0) {
                    popularMangaSection.innerHTML = '<p class="col-span-full text-center text-gray-500 dark:text-gray-400">No popular manga found.</p>';
                    return;
                }

                mangaList.forEach(manga => {
                    const coverUrl = manga.coverArtFileName ? getCoverArtUrl(manga.id, manga.coverArtFileName, 'thumb') : 'https://via.placeholder.com/200x280?text=No+Cover';
                    const title = manga.title;
                    const genres = manga.tags.slice(0, 2).join(', '); // Ambil 2 genre pertama
                    const lastChapterDisplay = manga.lastChapter ? `Chapter ${manga.lastChapter}` : 'N/A';

                    const mangaCardHtml = `
                        <div class="manga-card group" data-manga-id="${manga.id}">
                            <a href="#" class="block relative rounded-xl overflow-hidden shadow-lg bg-white dark:bg-dark-700">
                                <div class="relative pt-[140%]">
                                    <img src="${coverUrl}" alt="${title} Cover" class="absolute inset-0 w-full h-full object-cover">
                                    <div class="absolute top-2 left-2 bg-gradient-to-r from-primary-500 to-primary-600 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg">
                                        <i class="fas fa-star mr-1"></i> ${manga.rating ? manga.rating.toFixed(1) : 'N/A'}
                                    </div>
                                    <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-3">
                                        <h3 class="text-white font-bold text-sm line-clamp-1">${title}</h3>
                                        <p class="text-gray-300 text-xs">${lastChapterDisplay}</p>
                                    </div>
                                </div>
                            </a>
                            <div class="mt-2 px-1">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <a href="#" class="font-medium text-sm group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors line-clamp-1">${title}</a>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">${genres}</p>
                                    </div>
                                    <button class="text-gray-400 hover:text-primary-600 dark:hover:text-primary-400">
                                        <i class="far fa-bookmark"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    popularMangaSection.insertAdjacentHTML('beforeend', mangaCardHtml);
                });

                attachMangaCardClickListeners();

            } catch (error) {
                console.error("Failed to render popular manga:", error);
                popularMangaSection.innerHTML = '<p class="col-span-full text-center text-red-500 dark:text-red-400">Failed to load manga. Please try again later.</p>';
            }
        }

        async function renderLatestManga() {
            const latestMangaSection = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3.gap-6');
            latestMangaSection.innerHTML = `
                <div class="col-span-full text-center py-8">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mx-auto mb-4"></div>
                    <p class="text-gray-600 dark:text-gray-300">Loading latest updates...</p>
                </div>
            `;

            try {
                const popularManga = await getMangaList('', 6, 0, ['cover_art', 'author']); // Ambil 6 manga terpopuler

                latestMangaSection.innerHTML = ''; // Bersihkan loader

                if (popularManga.length === 0) {
                    latestMangaSection.innerHTML = '<p class="col-span-full text-center text-gray-500 dark:text-gray-400">No latest updates found.</p>';
                    return;
                }

                for (const manga of popularManga) {
                    const chapters = await getMangaChapters(manga.id, 1); // Ambil chapter terakhir
                    const latestChapter = chapters.length > 0 ? chapters[0] : null;

                    const coverUrl = manga.coverArtFileName ? getCoverArtUrl(manga.id, manga.coverArtFileName, 'thumb') : 'https://via.placeholder.com/200x280?text=No+Cover';
                    const title = manga.title;
                    const author = manga.author;
                    const genres = manga.tags.slice(0, 2).map(tag => `<span class="bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 px-2 py-0.5 rounded mr-2">${tag}</span>`).join('');
                    
                    let chapterInfo = '<span class="text-sm font-medium">N/A</span>';
                    let timeAgo = '<span class="text-xs text-gray-500 dark:text-gray-400">N/A</span>';

                    if (latestChapter) {
                        chapterInfo = `<span class="text-sm font-medium">Chapter ${latestChapter.chapter || 'N/A'} - ${latestChapter.title || 'No Title'}</span>`;
                        const publishedDate = new Date(latestChapter.publishAt);
                        const now = new Date();
                        const diffMs = now - publishedDate;
                        const diffMinutes = Math.round(diffMs / (1000 * 60));
                        const diffHours = Math.round(diffMs / (1000 * 60 * 60));
                        const diffDays = Math.round(diffMs / (1000 * 60 * 60 * 24));
                        
                        if (diffMinutes < 60) {
                            timeAgo = `<span class="text-xs text-gray-500 dark:text-gray-400">${diffMinutes} minutes ago</span>`;
                        } else if (diffHours < 24) {
                            timeAgo = `<span class="text-xs text-gray-500 dark:text-gray-400">${diffHours} hours ago</span>`;
                        } else {
                            timeAgo = `<span class="text-xs text-gray-500 dark:text-gray-400">${diffDays} days ago</span>`;
                        }
                    }

                    const latestUpdateCardHtml = `
                        <div class="bg-white dark:bg-dark-700 rounded-lg shadow-md overflow-hidden">
                            <div class="flex">
                                <div class="w-1/3">
                                    <img src="${coverUrl}" alt="${title} Cover" class="w-full h-full object-cover">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg mb-1 truncate">${title}</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">By ${author}</p>
                                    <div class="flex flex-wrap items-center text-sm text-gray-500 dark:text-gray-400 mb-3">
                                        ${genres}
                                    </div>
                                    <div class="flex items-center justify-between">
                                        ${chapterInfo}
                                        ${timeAgo}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    latestMangaSection.insertAdjacentHTML('beforeend', latestUpdateCardHtml);
                }
            } catch (error) {
                console.error("Failed to render latest manga:", error);
                latestMangaSection.innerHTML = '<p class="col-span-full text-center text-red-500 dark:text-red-400">Failed to load latest updates. Please try again later.</p>';
            }
        }

        async function populateMangaDetailModal(mangaId) {
            const modalContent = mangaDetailModal.querySelector('.inline-block');
            modalContent.innerHTML = `
                <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4 text-center">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mx-auto mb-4"></div>
                    <p class="text-gray-600 dark:text-gray-300">Loading manga details...</p>
                </div>
            `;

            try {
                const manga = await getMangaDetails(mangaId);
                if (!manga) {
                    modalContent.innerHTML = '<p class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4 text-center text-red-500 dark:text-red-400">Manga details not found.</p>';
                    return;
                }

                const coverUrl = manga.coverArtFileName ? getCoverArtUrl(manga.id, manga.coverArtFileName) : 'https://via.placeholder.com/400x600?text=No+Cover';
                const genresHtml = manga.tags.map(tag => `<span class="bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 px-3 py-1 rounded-full text-sm">${tag}</span>`).join('');
                
                const ratingDisplay = 'N/A';
                const totalRatingsDisplay = 'N/A';

                modalContent.innerHTML = `
                    <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                        <div class="flex flex-col md:flex-row">
                            <div class="md:w-1/3 mb-6 md:mb-0 md:pr-6">
                                <img src="${coverUrl}" alt="${manga.title} Cover" class="rounded-lg shadow-md w-full h-auto">
                            </div>
                            <div class="md:w-2/3">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-2xl font-bold mb-2">${manga.title}</h3>
                                        <p class="text-gray-600 dark:text-gray-300 mb-4">By ${manga.author}</p>
                                    </div>
                                    <button id="closeDetailModal" class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
                                        <i class="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    ${genresHtml}
                                </div>
                                <div class="flex items-center mb-4">
                                    <div class="flex mr-2">
                                        <i class="fas fa-star text-yellow-400"></i>
                                        <i class="fas fa-star text-yellow-400"></i>
                                        <i class="fas fa-star text-yellow-400"></i>
                                        <i class="fas fa-star text-yellow-400"></i>
                                        <i class="fas fa-star-half-alt text-yellow-400"></i>
                                    </div>
                                    <span class="text-gray-600 dark:text-gray-300 text-sm">${ratingDisplay} (${totalRatingsDisplay} ratings)</span>
                                </div>
                                <div class="mb-4">
                                    <h4 class="font-bold mb-2">Synopsis</h4>
                                    <p class="text-gray-700 dark:text-gray-300 text-sm">${manga.description}</p>
                                </div>
                                <div class="mb-6">
                                    <h4 class="font-bold mb-2">Details</h4>
                                    <div class="grid grid-cols-2 gap-2 text-sm">
                                        <div>
                                            <span class="text-gray-600 dark:text-gray-400">Status:</span>
                                            <span class="font-medium">${manga.status}</span>
                                        </div>
                                        <div>
                                            <span class="text-gray-600 dark:text-gray-400">Chapters:</span>
                                            <span class="font-medium">${manga.lastChapter || 'N/A'}</span>
                                        </div>
                                        <div>
                                            <span class="text-gray-600 dark:text-gray-400">Published:</span>
                                            <span class="font-medium">${manga.year || 'N/A'}</span>
                                        </div>
                                        <div>
                                            <span class="text-gray-600 dark:text-gray-400">Author:</span>
                                            <span class="font-medium">${manga.author}</span>
                                        </div>
                                        <div>
                                            <span class="text-gray-600 dark:text-gray-400">Artist:</span>
                                            <span class="font-medium">${manga.artist || 'N/A'}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex flex-col sm:flex-row gap-3">
                                    <button id="readNowButton" data-manga-id="${manga.id}" class="bg-primary-600 hover:bg-primary-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex-1 text-center">
                                        <i class="fas fa-book-open mr-2"></i> Read Now
                                    </button>
                                    <button class="bg-gray-200 dark:bg-dark-600 hover:bg-gray-300 dark:hover:bg-dark-500 text-gray-800 dark:text-gray-200 px-6 py-3 rounded-lg font-medium transition-colors flex-1 text-center">
                                        <i class="fas fa-bookmark mr-2"></i> Bookmark
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                document.getElementById('closeDetailModal').addEventListener('click', () => {
                    mangaDetailModal.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                });

                document.getElementById('readNowButton').addEventListener('click', async (e) => {
                    e.preventDefault();
                    const mangaIdToRead = e.currentTarget.dataset.mangaId;
                    const chapters = await getMangaChapters(mangaIdToRead, 1);
                    if (chapters.length > 0) {
                        openReaderModal(chapters[0].id, manga.title, chapters[0].chapter);
                    } else {
                        alert('No chapters found for this manga.');
                    }
                });

            } catch (error) {
                console.error("Failed to populate manga detail modal:", error);
                modalContent.innerHTML = '<p class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4 text-center text-red-500 dark:text-red-400">Error loading details. Please try again.</p>';
            }
        }

        async function openReaderModal(chapterId, mangaTitle, chapterNumber) {
            document.body.style.overflow = 'hidden';
            readerModal.classList.remove('hidden');

            const readerTitle = readerModal.querySelector('#readerHeader h3');
            readerTitle.textContent = `${mangaTitle} - Chapter ${chapterNumber}`;

            const readerContentDiv = readerModal.querySelector('#readerContent');
            readerContentDiv.innerHTML = `
                <div class="h-full flex items-center justify-center overflow-auto">
                    <div class="max-w-screen-lg w-full px-4 py-16 text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mx-auto mb-4"></div>
                        <p class="text-white">Loading chapter pages...</p>
                    </div>
                </div>
            `;

            try {
                const chapterImagesData = await getChapterImages(chapterId);
                if (!chapterImagesData || chapterImagesData.images.length === 0) {
                    readerContentDiv.innerHTML = `
                        <div class="h-full flex items-center justify-center overflow-auto">
                            <div class="max-w-screen-lg w-full px-4 py-16 text-center">
                                <p class="text-red-400">Failed to load chapter images or no images found.</p>
                            </div>
                        </div>
                    `;
                    return;
                }

                const imageUrls = buildChapterImageUrls(chapterImagesData.baseUrl, chapterImagesData.chapterHash, chapterImagesData.images);
                
                let pagesHtml = '<div class="w-full max-w-screen-md mx-auto reader-container overflow-y-auto h-full">';
                imageUrls.forEach((url, index) => {
                    pagesHtml += `
                        <img src="${url}" class="w-full reader-page mb-4 rounded-lg shadow-lg" alt="Page ${index + 1}" loading="lazy">
                    `;
                });
                pagesHtml += '</div>';
                
                readerContentDiv.innerHTML = pagesHtml;

                const pageCountSpan = readerModal.querySelector('#readerFooter span:last-child');
                pageCountSpan.textContent = `1/${imageUrls.length}`;

                const chapterSelect = readerModal.querySelector('#readerFooter select');
                chapterSelect.innerHTML = '';
                imageUrls.forEach((_, index) => {
                    const option = document.createElement('option');
                    option.value = index + 1;
                    option.textContent = `Page ${index + 1}`;
                    chapterSelect.appendChild(option);
                });

                const readerScrollContainer = readerContentDiv.querySelector('.reader-container');
                if (readerScrollContainer) {
                    readerScrollContainer.addEventListener('scroll', () => {
                        const pageHeight = readerScrollContainer.scrollHeight / imageUrls.length;
                        const currentPage = Math.ceil(readerScrollContainer.scrollTop / pageHeight) + 1;
                        pageCountSpan.textContent = `${Math.min(currentPage, imageUrls.length)}/${imageUrls.length}`;
                        chapterSelect.value = Math.min(currentPage, imageUrls.length);
                    });
                }


            } catch (error) {
                console.error("Error loading chapter images:", error);
                readerContentDiv.innerHTML = `
                    <div class="h-full flex items-center justify-center overflow-auto">
                        <div class="max-w-screen-lg w-full px-4 py-16 text-center">
                            <p class="text-red-400">Error loading chapter. Please try again.</p>
                        </div>
                    </div>
                `;
            }
        }

        function attachMangaCardClickListeners() {
            const mangaCards = document.querySelectorAll('.manga-card');
            mangaCards.forEach(card => {
                // Ensure no duplicate listeners by removing before adding
                card.removeEventListener('click', handleMangaCardClick); 
                card.addEventListener('click', handleMangaCardClick);
            });
        }

        function handleMangaCardClick(e) {
            e.preventDefault();
            const mangaCard = e.currentTarget;
            const mangaId = mangaCard.dataset.mangaId;
            if (mangaId) {
                mangaDetailModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                populateMangaDetailModal(mangaId);
            }
        }

        const heroReadNowButton = document.querySelector('.hero-section .bg-white.text-primary-600');
        if (heroReadNowButton) {
            heroReadNowButton.addEventListener('click', async (e) => {
                e.preventDefault();
                try {
                    const popularManga = await getMangaList('', 1, 0, ['cover_art', 'author']);
                    if (popularManga.length > 0) {
                        const mangaId = popularManga[0].id;
                        const chapters = await getMangaChapters(mangaId, 1);
                        if (chapters.length > 0) {
                            openReaderModal(chapters[0].id, popularManga[0].title, chapters[0].chapter);
                        } else {
                            alert('No chapters found for the featured manga.');
                        }
                    } else {
                        alert('No featured manga found to read.');
                    }
                } catch (error) {
                    console.error("Error clicking hero read now:", error);
                    alert('Could not start reading. Please try again later.');
                }
            });
        }
        
        const mangaDetailModal = document.getElementById('mangaDetailModal');
        const closeDetailModal = document.getElementById('closeDetailModal');
        
        window.addEventListener('click', (e) => {
            if (e.target === mangaDetailModal) {
                mangaDetailModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        });
        
        // AI Image Search Functionality
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const uploadButton = document.getElementById('uploadButton');
        const cameraButton = document.getElementById('cameraButton');
        const resultsContainer = document.getElementById('resultsContainer');
        
        // Prevent default drag behaviors
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        // Highlight drop area when item is dragged over it
        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight() {
            dropArea.classList.add('border-primary-500', 'bg-primary-50', 'dark:bg-dark-700');
        }
        
        function unhighlight() {
            dropArea.classList.remove('border-primary-500', 'bg-primary-50', 'dark:bg-dark-700');
        }
        
        // Handle dropped files
        dropArea.addEventListener('drop', handleDrop, false);
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }
        
        // Handle file selection via button
        uploadButton.addEventListener('click', () => {
            fileInput.click();
        });
        
        fileInput.addEventListener('change', function() {
            if (this.files.length) {
                handleFiles(this.files);
            }
        });
        
        // Handle camera capture
        cameraButton.addEventListener('click', () => {
            fileInput.setAttribute('capture', 'environment');
            fileInput.click();
        });
        
        // Process uploaded files
        function handleFiles(files) {
            const file = files[0];
            if (file && file.type.startsWith('image/')) {
                displayPreview(file);
                simulateSearch(file);
            }
        }
        
        // Display image preview
        function displayPreview(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                dropArea.innerHTML = `
                    <div class="relative h-full">
                        <img src="${e.target.result}" alt="Preview" class="max-h-64 mx-auto rounded">
                        <p class="mt-4 text-gray-700 dark:text-gray1-300">${file.name}</p>
                        <button id="changeImage" class="mt-3 text-primary-600 dark:text-primary-400 hover:underline">Change Image</button>
                    </div>
                `;
                
                document.getElementById('changeImage').addEventListener('click', resetUpload);
            };
            reader.readAsDataURL(file);
        }
        
        // Simulate AI search (for demo)
        function simulateSearch(file) {
            resultsContainer.innerHTML = `
                <div class="flex flex-col items-center justify-center">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mb-4"></div>
                    <p>Searching for matching manga...</p>
                </div>
            `;
            
            // Simulate API call delay
            setTimeout(() => {
                showResults();
            }, 2000);
        }
        
        // Show dummy results (for demo)
        function showResults() {
            resultsContainer.innerHTML = `
                <div class="fade-in">
                    <h4 class="font-bold mb-4 text-lg">We found a match!</h4>
                    <div class="flex items-center space-x-4">
                        <img src="https://via.placeholder.com/80x120/4f46e5/ffffff?text=AOT" alt="Manga Cover" class="w-20 h-auto rounded shadow">
                        <div>
                            <h5 class="font-bold">Attack on Titan: Final Season</h5>
                            <p class="text-sm text-gray-600 dark:text-gray-300 mb-2">By Hajime Isayama</p>
                            <button class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-1 rounded text-sm">
                                View Details
                            </button>
                        </div>
                    </div>
                    <div class="mt-6">
                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-2">Confidence: 92%</p>
                        <p class="text-sm text-gray-600 dark:text-gray-400">Chapter 138 - Page 12</p>
                    </div>
                </div>
            `;
        }
        
        // Reset upload
        function resetUpload() {
            dropArea.innerHTML = `
                <div class="flex justify-center mb-4">
                    <i class="fas fa-image text-4xl text-primary-500"></i>
                </div>
                <h3 class="text-lg font-semibold mb-2">Drag & Drop Image Here</h3>
                <p class="text-gray-500 dark:text-gray-400 mb-4">or</p>
                <button id="uploadButton" class="bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                    Browse Files
                </button>
                <button id="cameraButton" class="mt-3 bg-gray-100 dark:bg-dark-700 hover:bg-gray-200 dark:hover:bg-dark-600 text-gray-800 dark:text-gray-200 px-6 py-2 rounded-lg font-medium transition-colors">
                    <i class="fas fa-camera mr-2"></i> Take Photo
                </button>
            `;
            
            // Reattach event listeners
            document.getElementById('uploadButton').addEventListener('click', () => fileInput.click());
            document.getElementById('cameraButton').addEventListener('click', () => {
                fileInput.setAttribute('capture', 'environment');
                fileInput.click();
            });
            
            resultsContainer.innerHTML = `
                <div class="flex justify-center mb-4">
                    <i class="fas fa-search text-3xl text-gray-400"></i>
                </div>
                <p class="text-gray-500 dark:text-gray-400">Upload a manga image or take a photo to search</p>
            `;
        }
        
        // Reader Modal
        const readerModal = document.getElementById('readerModal');
        const closeReader = document.getElementById('closeReader');
        const readerHeader = document.getElementById('readerHeader');
        const readerFooter = document.getElementById('readerFooter');
        const readerContent = document.getElementById('readerContent');
        
        let hideControlsTimeout;
        
        function showReaderControls() {
            readerHeader.classList.remove('opacity-0');
            readerFooter.classList.remove('opacity-0');
            
            clearTimeout(hideControlsTimeout);
            hideControlsTimeout = setTimeout(() => {
                readerHeader.classList.add('opacity-0');
                readerFooter.classList.add('opacity-0');
            }, 3000);
        }
        
        showReaderControls();
        
        document.addEventListener('mousemove', showReaderControls);
        document.addEventListener('touchstart', showReaderControls);
        
        closeReader.addEventListener('click', () => {
            readerModal.classList.add('hidden');
            document.body.style.overflow = 'auto';
        });
        
        readerModal.addEventListener('click', (e) => {
            if (e.target === readerModal) {
                readerModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        });
        
        document.addEventListener('keydown', (e) => {
            if (!readerModal.classList.contains('hidden')) {
                if (e.key === 'Escape') {
                    readerModal.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }
            }
        });

        // Panggil fungsi render saat DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            renderPopularManga();
            renderLatestManga();
        });
    </script>
</body>
</html>
